<!doctype html><html lang=vi><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>6. K·ªπ thu·∫≠t T·ªëi ∆∞u h√≥a Truy v·∫•n - RDS Performance Insights & T·ªëi ∆Øu H√≥a Truy V·∫•n</title>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:work sans,helvetica,tahoma,geneva,arial,sans-serif;font-weight:300;line-height:1.6;font-size:18px}#sidebar{position:fixed;top:0;left:0;width:300px;height:100vh;background:#282828;color:#ccc;overflow-y:auto;z-index:1000}#sidebar .searchbox{padding:10px;background:#323232}#sidebar .searchbox input{width:100%;padding:10px;border:none;background:#404040;color:#ccc;border-radius:4px}#sidebar-toggle-span{display:none}#body{margin-left:300px}#body .padding{padding:3rem 6rem}#sidebar ul{list-style:none;padding:0;margin:0}#sidebar ul li a{display:block;padding:10px 20px;color:#ccc;text-decoration:none;border-left:4px solid transparent}#sidebar ul li a:hover{background:#404040;border-left-color:#599a3e}#sidebar ul li.active>a{background:#404040;border-left-color:#599a3e;color:#ccc}#sidebar ul ul{padding-left:20px}#sidebar ul ul li a{padding:8px 20px;font-size:.9em}#sidebar #header{padding:2rem 1rem;text-align:center}#sidebar #header .baseurl{color:#599a3e;font-size:1.5rem;font-weight:700}.language-switcher{position:relative;padding:20px}.language-switcher a{color:#599a3e;text-decoration:none;margin-left:10px}h1,h2,h3,h4,h5,h6{color:#5e5e5e;font-weight:400}h1{font-size:3rem}.chapter h1{color:#599a3e;border-bottom:4px solid #f0f2f4;padding-bottom:1rem;margin-bottom:2rem}.page-list{margin-top:2rem}.page-item{margin:1rem 0;padding:1rem;border:1px solid #e0e0e0;border-radius:4px}.page-item h2{margin:0 0 .5rem}.page-item h2 a{color:#599a3e;text-decoration:none}.page-item h2 a:hover{text-decoration:underline}.page-item p{color:#666;margin:0}.breadcrumbs{margin-bottom:2rem;color:#999}.breadcrumbs a{color:#599a3e;text-decoration:none}.breadcrumbs a:hover{text-decoration:underline}@media(max-width:768px){#sidebar{transform:translateX(-300px);transition:transform .3s}#sidebar.open{transform:translateX(0)}#body{margin-left:0}#body .padding{padding:1rem 2rem}#sidebar-toggle-span{display:block;position:fixed;top:10px;left:10px;z-index:1001}#sidebar-toggle{background:#599a3e;color:#fff;padding:10px;border:none;border-radius:4px}}</style></head><body><nav id=sidebar><div id=header><a id=logo href=/><div style=text-align:center;padding:20px><h2 style=color:var(--MENU-SEARCH-BOX-color,#33a1ff);font-size:2rem;font-weight:700;margin:0>LEARN</h2><p style="color:var(--MENU-SEARCH-BOX-ICONS-color,#a1d2fd);font-size:.9rem;margin:5px 0 0">RDS Performance Insights</p></div></a></div><div class=searchbox><input type=search placeholder=Search... id=search-input></div><ul class=topics><li><a href=http://localhost:1313/><i class="fas fa-home"></i> Home</a></li><li><a href=/vi/introduction/><i class="fas fa-book"></i> 1. Gi·ªõi Thi·ªáu</a></li><li><a href=/vi/preparation/><i class="fas fa-book"></i> 2. Chu·∫©n B·ªã</a></li><li><a href=/vi/performance-baseline/><i class="fas fa-book"></i> 3. Thi·∫øt l·∫≠p ƒê∆∞·ªùng c∆° s·ªü Hi·ªáu su·∫•t</a></li><li><a href=/vi/performance-insights/><i class="fas fa-book"></i> Performance Insights</a></li><li><a href=/vi/monitoring-dashboard/><i class="fas fa-book"></i> 4. B·∫£ng ƒëi·ªÅu khi·ªÉn Gi√°m s√°t</a></li><li><a href=/vi/alerting-system/><i class="fas fa-book"></i> 5. H·ªá th·ªëng C·∫£nh b√°o</a></li><li class=active><a href=/vi/query-optimization/><i class="fas fa-book"></i> 6. K·ªπ thu·∫≠t T·ªëi ∆∞u h√≥a Truy v·∫•n</a><ul><li><a href=/vi/query-optimization/overview/>T·ªïng quan</a></li><li><a href=/vi/query-optimization/index-strategies/>Chi·∫øn l∆∞·ª£c Index</a></li><li><a href=/vi/query-optimization/query-rewriting/>Vi·∫øt l·∫°i Truy v·∫•n</a></li><li><a href=/vi/query-optimization/execution-plans/>K·∫ø ho·∫°ch Th·ª±c thi</a></li></ul></li><li><a href=/vi/automated-tuning/><i class="fas fa-book"></i> 7. ƒê·ªÅ xu·∫•t ƒêi·ªÅu ch·ªânh T·ª± ƒë·ªông</a></li><li><a href=/vi/capacity-planning/><i class="fas fa-book"></i> 8. L·∫≠p k·∫ø ho·∫°ch NƒÉng l·ª±c</a></li><li><a href=/vi/monitoring/><i class="fas fa-book"></i> 9. Gi√°m s√°t & C·∫£nh b√°o</a></li><li><a href=/vi/best-practices/><i class="fas fa-book"></i> 10. D·ªçn d·∫πp t√†i nguy√™n</a></li></ul><div class=language-switcher><a href=/vi/en><i class="fas fa-language"></i> English</a></div></nav><span id=sidebar-toggle-span><a href=# id=sidebar-toggle><i class="fas fa-bars"></i></a></span><section id=body><div id=overlay></div><div class=padding><div id=body-inner><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>
<span>> </span><a href=/vi/>RDS Performance Insights & T·ªëi ∆Øu H√≥a Truy V·∫•n</a>
<span>> </span>6. K·ªπ thu·∫≠t T·ªëi ∆∞u h√≥a Truy v·∫•n</div><div class=chapter><h1>6. K·ªπ thu·∫≠t T·ªëi ∆∞u h√≥a Truy v·∫•n</h1><h3 id=ch∆∞∆°ng-6>Ch∆∞∆°ng 6</h3><h1 id=k·ªπ-thu·∫≠t-t·ªëi-∆∞u-h√≥a-truy-v·∫•n>K·ªπ thu·∫≠t T·ªëi ∆∞u h√≥a Truy v·∫•n</h1><p>C√°c ph∆∞∆°ng ph√°p ƒë·ªÉ c·∫£i thi·ªán hi·ªáu su·∫•t c·ªßa c√°c truy v·∫•n SQL.</p><h2 id=m·ª•c-ti√™u>M·ª•c ti√™u</h2><p>Gi·∫£m th·ªùi gian th·ª±c thi truy v·∫•n, gi·∫£m t√†i nguy√™n ti√™u th·ª•.</p><h2 id=c√°c-ngu·ªìn-ph√°t-hi·ªán-v·∫•n-ƒë·ªÅ>C√°c ngu·ªìn ph√°t hi·ªán v·∫•n ƒë·ªÅ</h2><h3 id=rds-performance-insights>RDS Performance Insights</h3><p>X√°c ƒë·ªãnh c√°c truy v·∫•n SQL ti√™u t·ªën nhi·ªÅu t√†i nguy√™n nh·∫•t (Top SQL).</p><h3 id=slow-query-logs>Slow Query Logs</h3><p>C√°c truy v·∫•n v∆∞·ª£t qu√° ng∆∞·ª°ng th·ªùi gian ƒë∆∞·ª£c ghi l·∫°i.</p><h3 id=database-activity-streams-das>Database Activity Streams (DAS)</h3><p>(V·ªõi Aurora v√† RDS cho PostgreSQL) Cung c·∫•p lu·ªìng ho·∫°t ƒë·ªông DB chi ti·∫øt ƒë·ªÉ ph√¢n t√≠ch s√¢u h∆°n.</p><h2 id=c√°c-k·ªπ-thu·∫≠t-t·ªëi-∆∞u-h√≥a>C√°c k·ªπ thu·∫≠t t·ªëi ∆∞u h√≥a</h2><h3 id=1-t·ªëi-∆∞u-h√≥a-index>1. T·ªëi ∆∞u h√≥a Index</h3><h4 id=t·∫°o-index-ph√π-h·ª£p>T·∫°o Index ph√π h·ª£p</h4><ul><li>C√°c c·ªôt trong m·ªánh ƒë·ªÅ WHERE</li><li>C√°c c·ªôt trong JOIN</li><li>C√°c c·ªôt trong ORDER BY, GROUP BY</li></ul><h4 id=qu·∫£n-l√Ω-index>Qu·∫£n l√Ω Index</h4><ul><li>X√≥a c√°c index kh√¥ng s·ª≠ d·ª•ng</li><li>S·ª≠ d·ª•ng Covering Index ƒë·ªÉ t·ªëi thi·ªÉu h√≥a vi·ªác truy c·∫≠p b·∫£ng</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- V√≠ d·ª• t·∫°o covering index
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>INDEX</span> idx_order_covering 
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> orders (customer_id, order_date) 
</span></span><span style=display:flex><span>INCLUDE (total_amount, status);
</span></span></code></pre></div><h3 id=2-vi·∫øt-l·∫°i-truy-v·∫•n-query-rewriting>2. Vi·∫øt l·∫°i Truy v·∫•n (Query Rewriting)</h3><h4 id=best-practices>Best Practices</h4><ul><li>Tr√°nh <code>SELECT *</code></li><li>T·ªëi ∆∞u h√≥a m·ªánh ƒë·ªÅ JOIN (ch·ªçn ƒë√∫ng lo·∫°i JOIN, th·ª© t·ª± JOIN)</li><li>Tr√°nh c√°c h√†m tr√™n c·ªôt c√≥ index trong m·ªánh ƒë·ªÅ WHERE</li><li>S·ª≠ d·ª•ng <code>UNION ALL</code> thay v√¨ <code>UNION</code> n·∫øu kh√¥ng c·∫ßn lo·∫°i b·ªè tr√πng l·∫∑p</li><li>T·ªëi ∆∞u h√≥a GROUP BY v√† ORDER BY</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- Thay v√¨
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> orders <span style=color:#66d9ef>WHERE</span> <span style=color:#66d9ef>YEAR</span>(order_date) <span style=color:#f92672>=</span> <span style=color:#ae81ff>2023</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- S·ª≠ d·ª•ng
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> order_id, customer_id, total_amount 
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> orders 
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> order_date <span style=color:#f92672>&gt;=</span> <span style=color:#e6db74>&#39;2023-01-01&#39;</span> 
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>AND</span> order_date <span style=color:#f92672>&lt;</span> <span style=color:#e6db74>&#39;2024-01-01&#39;</span>;
</span></span></code></pre></div><h3 id=3-t·ªëi-∆∞u-h√≥a-schema>3. T·ªëi ∆∞u h√≥a Schema</h3><h4 id=l·ª±a-ch·ªçn-ki·ªÉu-d·ªØ-li·ªáu>L·ª±a ch·ªçn ki·ªÉu d·ªØ li·ªáu</h4><ul><li>Ch·ªçn ki·ªÉu d·ªØ li·ªáu ph√π h·ª£p (v√≠ d·ª•: d√πng INT thay v√¨ BIGINT n·∫øu ƒë·ªß)</li><li>Chu·∫©n h√≥a/Phi chu·∫©n h√≥a ph√π h·ª£p v·ªõi workload</li></ul><h4 id=ph√¢n-v√πng-b·∫£ng-table-partitioning>Ph√¢n v√πng b·∫£ng (Table Partitioning)</h4><p>Cho c√°c b·∫£ng l·ªõn ƒë·ªÉ c·∫£i thi·ªán hi·ªáu su·∫•t truy v·∫•n.</p><h3 id=4-s·ª≠-d·ª•ng-caching>4. S·ª≠ d·ª•ng Caching</h3><h4 id=application-level-caching>Application-level Caching</h4><p>Cache k·∫øt qu·∫£ truy v·∫•n ·ªü t·∫ßng ·ª©ng d·ª•ng:</p><ul><li>Redis</li><li>Memcached</li></ul><h4 id=database-level-caching>Database-level Caching</h4><p>T·ª± ƒë·ªông b·ªüi RDS, nh∆∞ng c·∫ßn t·ªëi ∆∞u h√≥a truy v·∫•n ƒë·ªÉ t·∫≠n d·ª•ng.</p></div><div class=page-list><div class=page-item><h2><a href=/vi/query-optimization/overview/>T·ªïng quan</a></h2><p>T·ªïng quan t·ªëi ∆∞u h√≥a truy v·∫•n üéØ T·ªëi ∆∞u h√≥a truy v·∫•n l√† g√¨? T·ªëi ∆∞u h√≥a truy v·∫•n l√† qu√° tr√¨nh c·∫£i thi·ªán hi·ªáu su·∫•t truy v·∫•n c∆° s·ªü d·ªØ li·ªáu th√¥ng qua c√°c k·ªπ thu·∫≠t kh√°c nhau bao g·ªìm t·ªëi ∆∞u h√≥a ch·ªâ m·ª•c, vi·∫øt l·∫°i truy v·∫•n v√† ph√¢n t√≠ch k·∫ø ho·∫°ch th·ª±c thi.
Th√¥ng tin: T·ªëi ∆∞u h√≥a truy v·∫•n hi·ªáu qu·∫£ c√≥ th·ªÉ c·∫£i thi·ªán hi·ªáu su·∫•t 70% ho·∫∑c h∆°n trong khi gi·∫£m ti√™u th·ª• t√†i nguy√™n.</p></div><div class=page-item><h2><a href=/vi/query-optimization/index-strategies/>Chi·∫øn l∆∞·ª£c Index</a></h2><p>Chi·∫øn l∆∞·ª£c Index - H·ªçc c√°c k·ªπ thu·∫≠t l·∫≠p ch·ªâ m·ª•c n√¢ng cao Vi·ªác s·ª≠ d·ª•ng index hi·ªáu qu·∫£ l√† y·∫øu t·ªë quan tr·ªçng nh·∫•t ƒë·ªÉ tƒÉng t·ªëc ƒë·ªô truy v·∫•n. M·ªôt index gi·ªëng nh∆∞ m·ª•c l·ª•c c·ªßa m·ªôt cu·ªën s√°ch, gi√∫p c∆° s·ªü d·ªØ li·ªáu t√¨m ki·∫øm d·ªØ li·ªáu nhanh h∆°n m√† kh√¥ng c·∫ßn qu√©t to√†n b·ªô b·∫£ng.
T·∫ßm quan tr·ªçng c·ªßa Index Khi m·ªôt truy v·∫•n ƒë∆∞·ª£c th·ª±c thi, n·∫øu kh√¥ng c√≥ index ph√π h·ª£p, c∆° s·ªü d·ªØ li·ªáu ph·∫£i th·ª±c hi·ªán qu√©t to√†n b·ªô b·∫£ng (full table scan) ƒë·ªÉ t√¨m ki·∫øm d·ªØ li·ªáu, ƒë·∫∑c bi·ªát t·ªën k√©m v·ªõi b·∫£ng l·ªõn.</p></div><div class=page-item><h2><a href=/vi/query-optimization/query-rewriting/>Vi·∫øt l·∫°i Truy v·∫•n</a></h2><p>Vi·∫øt l·∫°i Truy v·∫•n - N·∫Øm v·ªØng c√°c m·∫´u t·ªëi ∆∞u h√≥a truy v·∫•n Vi·∫øt l·∫°i ho·∫∑c ƒëi·ªÅu ch·ªânh c·∫•u tr√∫c c·ªßa truy v·∫•n SQL c√≥ th·ªÉ ·∫£nh h∆∞·ªüng l·ªõn ƒë·∫øn c√°ch c∆° s·ªü d·ªØ li·ªáu th·ª±c thi ch√∫ng. M·ª•c ti√™u l√† gi√∫p tr√¨nh t·ªëi ∆∞u h√≥a truy v·∫•n (Query Optimizer) c·ªßa c∆° s·ªü d·ªØ li·ªáu ch·ªçn m·ªôt k·∫ø ho·∫°ch th·ª±c thi hi·ªáu qu·∫£ h∆°n.
C√°c nguy√™n t·∫Øc c∆° b·∫£n Tr√°nh SELECT * Ch·ªâ ch·ªçn nh·ªØng c·ªôt b·∫°n th·ª±c s·ª± c·∫ßn.</p></div><div class=page-item><h2><a href=/vi/query-optimization/execution-plans/>K·∫ø ho·∫°ch Th·ª±c thi</a></h2><p>K·∫ø ho·∫°ch Th·ª±c thi - Hi·ªÉu v√† ph√¢n t√≠ch k·∫ø ho·∫°ch truy v·∫•n K·∫ø ho·∫°ch th·ª±c thi l√† &ldquo;l·ªô tr√¨nh&rdquo; m√† c∆° s·ªü d·ªØ li·ªáu s·∫Ω ƒëi theo ƒë·ªÉ th·ª±c hi·ªán m·ªôt truy v·∫•n. Hi·ªÉu ƒë∆∞·ª£c n√≥ l√† ch√¨a kh√≥a ƒë·ªÉ ch·∫©n ƒëo√°n v√† kh·∫Øc ph·ª•c c√°c v·∫•n ƒë·ªÅ hi·ªáu su·∫•t truy v·∫•n.
C√°ch l·∫•y Execution Plan S·ª≠ d·ª•ng EXPLAIN S·ª≠ d·ª•ng l·ªánh EXPLAIN tr∆∞·ªõc b·∫•t k·ª≥ truy v·∫•n SQL n√†o:</p></div></div></div></div></section><script>document.getElementById("sidebar-toggle").addEventListener("click",function(e){e.preventDefault(),document.getElementById("sidebar").classList.toggle("open")})</script></body></html>